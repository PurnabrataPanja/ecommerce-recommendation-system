{% extends "base.html" %}
{% block content %}

<div style="display:flex;">

    <!-- LEFT SIDEBAR -->
    <div style="width:250px; padding:20px; border-right:1px solid #ddd;">

        <h3>Categories</h3>
        <ul style="list-style:none; padding:0;">
            <li><a href="?">All</a></li>
            {% for cat in categories %}
                {% if cat %}
                <li>
                    <a href="?category={{ cat }}">{{ cat }}</a>
                </li>
                {% endif %}
            {% endfor %}
        </ul>

        <hr>

        <h3>Filter by Price</h3>
        <form method="get">
            <input type="number" name="min_price" placeholder="Min Price" style="width:100%; margin-bottom:10px;">
            <input type="number" name="max_price" placeholder="Max Price" style="width:100%; margin-bottom:10px;">
            <button type="submit">Apply</button>
        </form>

        <hr>

        <h3>Sort</h3>
        <ul style="list-style:none; padding:0;">
            <li><a href="?sort=price_low">Price: Low → High</a></li>
            <li><a href="?sort=price_high">Price: High → Low</a></li>
            <li><a href="?sort=rating">Top Rated</a></li>
        </ul>

    </div>


    <!-- PRODUCT GRID -->
    <div style="flex:1; padding:20px;">

        <!-- Search Bar -->
        <form method="get" style="margin-bottom:20px;">
            <input type="text" name="search" placeholder="Search products..." style="width:60%;">
            <button type="submit">Search</button>
        </form>

        <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap:20px;">

            {% for product in products %}
            <div style="border:1px solid #ccc; padding:15px;">

                <a href="{% url 'product_detail' product.id %}">
                    {% if product.image_url %}
                        <img src="{{ product.image_url }}" style="width:100%; height:200px; object-fit:cover;">
                    {% endif %}
                    <h4>{{ product.name|truncatechars:40 }}</h4>
                </a>

                <p><strong>₹ {{ product.price }}</strong></p>
                <p>⭐ {{ product.rating }}</p>

                <a href="{% url 'add_to_cart' product.id %}">
                    Add to Cart
                </a>

            </div>
            {% endfor %}

        </div>

    </div>

</div>

{% endblock %}